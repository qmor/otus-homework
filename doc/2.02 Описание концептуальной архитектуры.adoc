=== Описание концептуальной архитектуры

Для обеспечения задач масштабирования, отказоустойчивости и возможности применения разных технологий для составных частей системы выбрана микросервисная архитектура. На схеме представлены следующие компоненты

[cols="2^8"]
|===
|Компонент | Описание

|Пользователи | Пользователи - сотрудники предприятия использующие для доступа к сервису - личные мобильные устройства на IOS и Android, десктопные и веб версии мессенджера

|Api-gateway | Входная точка для подключения клиентских мессенждеров, их авторизации. Используется HTTPS и websocket. Маршрутизирует запросы от пользователя между компонентами системы.

|Сервис авторизации | аутентифицирует пользователя - на основании информации из сервиса пользователей, предоставляет авторизацию на различные действия например блокировку пользователей - глобальное удаление сообщений. Также сервис имплементирует one time password чтобы не смешивать общий пароль пользователя на предприятии и пароль для мессенждера

|Сервис директ чатов | Реализует функциональность директ чатов пользователь - пользователь - хранит данные чатов в БД PostgreSQL

|Сервис пользователей | Хранит информацию о пользователях (postgreSQL), полученную от внешней интеграции с LDAP предприятия, так и информацию которую пользователь указал о себе, статус блокировки пользователя (например в стучае увольнения) аватары и т.д. 

|Сервис медиа| Хранит и отдает мультимедиа материалы (картинки, документы, видео) хранящиеся в s3 хранилище. метаинформация о медия (пользователь - владелец, ссылка на s3) хранятся в postgreSQL

|Сервис групповых чатов| Реализует функциональность каналов и групповых чатов - испольует postgreSQL
|Сервис уведомлений| Реализует функциональность доставки пользователям сообщений из групповых и директ чатов онлайн и после взода пользователя после отутствия - использует postgreSQL
Также используется для взаимодействия с mail сервером для пересылки OTP пользователю
|Брокер сообщений | Kafka для асинхронного взаимодейтствия между сервисами
|Сервис поиска| Поиск пользователем по истории директ и групповых чатов и каналов Использует Elasticsearch



Синхронные взаимодействия между сервисами по rest, асинхронные через kafka